//*************************************************************************
//			シーン切り替えマシーン[CSceneChanger.cpp ]
//
//			Toshiki Kuwazoe
//			2017/8/20
//
//*************************************************************************

//*************************************************************************
//			インクルードファイル
//*************************************************************************
#include "main.h"
#include "CSceneChanger.h"

//*************************************************************************
//			マクロ定義
//*************************************************************************

//*************************************************************************
//			グローバル変数
//*************************************************************************

//*************************************************************************
//			コンストラクタ
//*************************************************************************
CSceneChanger::CSceneChanger()
{
	m_pScene = NULL;
	m_pNextScene = NULL;
}

//*************************************************************************
//			デストラクタ
//*************************************************************************
CSceneChanger::~CSceneChanger()
{
	if (m_pScene)
	{
		m_pScene->Uninit();
		delete m_pScene;
		m_pScene = NULL;
	}
}

//*************************************************************************
//			初期化処理関数
//*************************************************************************
HRESULT CSceneChanger::Init(CScene *pScene)
{
	// 最初のシーンを代入する
	m_pScene = pScene;
	// 次のシーン指定
	m_pNextScene = pScene;
	// シーン初期化
	m_pScene->Init();

	return S_OK;
}

//*************************************************************************
//			終了処理関数
//*************************************************************************
void CSceneChanger::Uninit()
{
	// 現在のシーン終了処理
	m_pScene->Uninit();
}

//*************************************************************************
//			更新処理関数
//*************************************************************************
void CSceneChanger::Update()
{
	// 現在のシーン更新処理
	m_pScene->Update();
}

//*************************************************************************
//			描画処理関数
//*************************************************************************
void CSceneChanger::Draw()
{
	// シーンが切り替わっていたら
	if (m_pScene != m_pNextScene)
	{
		m_pScene->Uninit();
		delete m_pScene;
		m_pScene = m_pNextScene;
		m_pScene->Init();
	}

	// 現在のシーンの描画処理
	// 書いてはいるけどもいらないかもしれない
	// 更新によってシーンが行われるため、更新内でシーンが切り替わった時
	// 何もないシーンを見ようとしてしまうから1フレーム置いた方がいいかも
	m_pScene->Draw();
}

//*************************************************************************
//			フェーズ切り替え処理関数
//*************************************************************************
void CSceneChanger::SceneChange(CScene *pNextScene)
{
	// 引数ポインタを代入する
	m_pNextScene = pNextScene;
}